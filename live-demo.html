<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Pocketsphinx.js Live Demo</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Pocketsphinx.js</h1>
        <h2>Speech recognition in JavaScript</h2>
        <a href="https://github.com/syl22-00/pocketsphinx.js" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h3>
	    <a name="pocketsphinxjs-live-demo" class="anchor" href="#pocketsphinxjs-live-demo"><span class="octicon octicon-link"></span></a>Pocketsphinx.js Live Demo.</h3>

	  <p>This demo works on Chrome with the Web Audio API, make sure it works for you and actually records audio (audio recording on Chrome does not work well on all configs).</p>

	  <h4>Press Start and speaking digits</h4>

	  <button id="startBtn">Start</button>
	  <button id="stopBtn">Stop</button>
	  <h4>Output</h4>
	  <pre id="output"></pre>
	  <h4>Error logs</h4>
	  <pre id="errors"></pre>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/syl22-00/pocketsphinx.js/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/syl22-00/pocketsphinx.js/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/syl22-00/pocketsphinx.js"></a> is maintained by <a href="https://github.com/syl22-00">syl22-00</a>.</p>

          <p>This page was generated by <a href="pages.github.com">GitHub Pages</a> using the Architect theme by <a href="http://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>
    <script>
      function updateHyp(hyp) {
      output.innerHTML = hyp;
      }
      function addLogs(logs) {
      errors.innerHTML += "\n" + logs;
      }
      
      var audio_context;
      var recorder;
      var recognizer;

      function startUserMedia(stream) {
      var input = audio_context.createMediaStreamSource(stream);
      input.connect(audio_context.destination);
      recorder = new AudioRecorder(input, recognizer);
      }

      var startRecording = function() {
      recorder && recorder.start();
      }

      var stopRecording = function() {
      recorder && recorder.stop();
      }

      window.onload = function init() {
      recognizer = new PS();
      recognizer.initialize();
      recognizer.addWord("ONE", "W AH N");
      recognizer.addWord("TWO", "T UW");
      recognizer.addWord("THREE", "TH R IY");
      recognizer.addWord("FOUR", "F AO R");
      recognizer.addWord("FIVE", "F AY V");
      recognizer.addWord("SIX", "S IH K S");
      recognizer.addWord("SEVEN", "S EH V AH N");
      recognizer.addWord("EIGHT", "EY T");
      recognizer.addWord("NINE", "N AY N");
      recognizer.addWord("ZERO", "Z IH R OW");
      recognizer.startGrammar(1);
      recognizer.addTransition(0, 0, "ONE");
      recognizer.addTransition(0, 0, "TWO");
      recognizer.addTransition(0, 0, "THREE");
      recognizer.addTransition(0, 0, "FOUR");
      recognizer.addTransition(0, 0, "FIVE");
      recognizer.addTransition(0, 0, "SIX");
      recognizer.addTransition(0, 0, "SEVEN");
      recognizer.addTransition(0, 0, "EIGHT");
      recognizer.addTransition(0, 0, "NINE");
      recognizer.addTransition(0, 0, "ZERO");
      recognizer.endGrammar();

      try {
      window.AudioContext = window.AudioContext || window.webkitAudioContext;
      navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia;
      window.URL = window.URL || window.webkitURL;

      audio_context = new AudioContext;
      } catch (e) {
      alert('No web audio support in this browser!');
      }

      navigator.getUserMedia({audio: true}, startUserMedia, function(e) {
      addLogs('No live audio input: ' + e);
      });
      document.getElementById('startBtn').onclick = startRecording;
      document.getElementById('stopBtn').onclick = stopRecording;

      };
    </script>
    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-41771114-1', 'syl22-00.github.io');
      ga('send', 'pageview');
    </script>
    <script src="js/audioRecorder.js"></script>
    <script src="js/webapp.js"></script>
    <script src="js/pocketsphinx.js"></script>

  </body>
</html>
